# Settings: CA_CERT

## Name

CA_CERT

## Type:

Environment Variable
    
## Location:

`dockercloud/haproxy` container or service

## Default Value

empty

## Description

This environment variable allows you to specify a CA Cert which is used to make HAProxy verify the SSL certificate of the downstream server. You can replace the new line character `\n`(1 char) in the pem file with `\ ` `n`(2 chars), and use the output as the value of this environment variable.

More details can be find [here](https://github.com/docker/dockercloud-haproxy#ssl-termination)

## Example

1. Use the following CA certificate as an example
```bash
$ cat ca.pem
-----BEGIN CERTIFICATE-----
MIIGJDCCBAygAwIBAgIJAOY/30XL4e+uMA0GCSqGSIb3DQEBCwUAMIGeMQswCQYD
VQQGEwJVUzELMAkGA1UECAwCQ0ExFjAUBgNVBAcMDVNhbiBGcmFuY2lzY28xFDAS
BgNVBAoMC0RvY2tlciwgSW5jMRUwEwYDVQQLDAxEb2NrZXIgQ2xvdWQxHTAbBgNV
BAMMFERvY2tlciBDbG91ZCBSb290IENBMR4wHAYJKoZIhvcNAQkBFg9pbmZvQGRv
Y2tlci5jb20wHhcNMTYxMTA5MDAyNzQyWhcNMzYxMTA0MDAyNzQyWjCBnjELMAkG
A1UEBhMCVVMxCzAJBgNVBAgMAkNBMRYwFAYDVQQHDA1TYW4gRnJhbmNpc2NvMRQw
EgYDVQQKDAtEb2NrZXIsIEluYzEVMBMGA1UECwwMRG9ja2VyIENsb3VkMR0wGwYD
VQQDDBREb2NrZXIgQ2xvdWQgUm9vdCBDQTEeMBwGCSqGSIb3DQEJARYPaW5mb0Bk
b2NrZXIuY29tMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA3DweegCj
mZWHnZmGg1DYooNHXybYbjAkE1k3ohJtfEKpikQYaVB00ir9UqsTK5/5xTBEDzgE
dMwToHEtDl0/7AIMdjLxTX8MSNm6sjhhQfJ9yYzZN+VtoM7xL4+j1BdM+j3+p96d
f2YubsUPpxReJkTzVg5NSz/himFq7CuxZuI2ucXcGOXrzQB/cVaeNWa5zjgeRTsl
+EJ6vwSmd+1SmU9D5VXMHStalDgedK6MPS6r54tqtpWZbga/+DDRLsW/TUAspdUm
in8rqXSlqbwMkjLLciSK0fFHJdHxK5/ISdUdd5uVxvsAXXKZ2AmkrZb2KCi1WYCv
c17XIa2mDdu6A3kHvWQbURdAdHO5/BYQ4lIHJVJ+tlf5gvIip0xjQrhvuI1rZ8fg
qWcwJTZsOPr+FCgmRQTlLfIA772+jFaZfrId0KtraoTmyZMxMzBKX7BUZusx9YxJ
ADzF9pyWRU8ylLLAYjRMrx5bT7s24vdmTYKwZAhBSzIAPFiP8BZBVPO9XsEhQGGx
O3qbrP2g+ly4Yjnxm1XfIYXCsbK/zIk/3GVKM0RJh+3qBmOgO9xwKSd3X5Tb0kre
fUNMuuXZd9bB5ZjjVrwMLq+CnDj2uvY+/MkeCOd6IvwvmVd5gjq4CT2q/NfaT9D1
fiU8pjCJkaxq1B2B5ymTWRsi1h94hqeesCkCAwEAAaNjMGEwHQYDVR0OBBYEFOe9
9xIAjpVg8WQjricWX8zDsB+uMB8GA1UdIwQYMBaAFOe99xIAjpVg8WQjricWX8zD
sB+uMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgGGMA0GCSqGSIb3DQEB
CwUAA4ICAQCDdu22+Fa1j007zItIXYM2MKnb/tN9GZ8NGj1hW1mV53RPDQYdigF8
9ybLPilECs165qlHd9UonamtMbxm7tMmLoLGMsdCCSDSXa3PmrtGO9D94vvNEO7B
35008VtvYK9r4Bj0AXmdQYftnRDBEeJU2ghjyzeslCmkRBD+uvGwSyI9XMMcyJaN
VU5Zg1Iz6iVkZxHGMvbl9cMNe9nQpMrerJJP79Y0myzER0+YM8dDkYs3B1ZWWd3K
onenlyorAWbsqJIDxOizTXrZLIKVjGN/bVNLZQELZ1fXgIjapSwdaievnzEsurUI
JVqh5m5K/GrwCvskUAADSCFuNPWEsNxu0JngLEhKTz0qFAHkCPLJXYFFdWanqQc8
VIfKi4pPk699BgftRg+zTpfZcmHctEHZ7TBOtrYHHUDVL03oL1Pxj13M6IJG0K5l
cZShLuMrxoF/bX321Vue1NWd/iB3NBkA4jiFwiuQIrspJtWBt4FFB9E7EpJJvogC
gTxbdtJR7xxp6bJw5wFZXeEHoveV+NR8cItLqTXOEasG9bTELXgrpr2j4WUyaV1N
k4MhTq41lEyCsmdz+GUtt4X753pWOVplxdaHQCP/RkhmrF/M9Rr8zu9cPdUecKbl
nD4ozS2BXmV1LD0kONxUI0oBdmZfpU6i+8xSSdmkNmIxVPcY/xFaCQ==
-----END CERTIFICATE-----
```

2. Run the following command for the conversion and copy the output

```bash
$ awk 1 ORS='\\n' ca.pem
-----BEGIN CERTIFICATE-----\n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\n-----END CERTIFICATE-----\n
```

3. Use the output to run `dockercloud/haproxy` with the following option:
```
-e  CA_CERT='-----BEGIN CERTIFICATE-----\n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\n-----END CERTIFICATE-----\n'
```

4. With the above setting, the CA certificate is created in `/cacerts/cert0.pem`, and the following configuration is added to the conf file:
```
    frontend default_port_443
>     bind :443  ca-file /cacerts/cert0.pem verify required
      reqadd X-Forwarded-Proto:\ https
      maxconn 4096
      default_backend default_service
    backend default_service
      server HELLO 172.17.0.2:80 check inter 2000 rise 2 fall 3
```